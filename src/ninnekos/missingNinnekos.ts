import { GraphQLClient } from 'graphql-request';
import query from '../query/index';
import '../db';
import ninnekos from '.';

(async () => {
    const endpoint = 'https://api.ninneko.com/graphql';

    const graphClient = new GraphQLClient(endpoint, { headers: {} });

    const ids = [
        92, 761, 971, 1142, 1487, 2171, 2242, 2394, 2468, 3364, 4013, 4668,
        4910, 5386, 5444, 6019, 6166, 6911, 7103, 7795, 7826, 7874, 7994, 8024,
        8312, 8548, 9040, 9124, 9972, 9986, 10256, 10302, 10473, 10624, 10822,
        11061, 11172, 11243, 11516, 11627, 11726, 11978, 12007, 12026, 12210,
        12275, 12307, 12318, 12390, 12643, 12702, 12754, 12780, 12782, 13098,
        13101, 13152, 13357, 13685, 13781, 14196, 14255, 14402, 14556, 15005,
        15075, 15297, 15448, 15499, 15988, 16105, 16603, 16901, 16935, 17049,
        17064, 17073, 17151, 17283, 17543, 17569, 17687, 17742, 17746, 17964,
        17970, 18014, 18098, 18345, 18378, 18409, 18626, 18671, 18899, 19173,
        19378, 19392, 19456, 19819, 19820, 19828, 20014, 20017, 20292, 20438,
        20520, 20652, 20839, 20847, 20974, 20992, 21011, 21015, 21045, 21075,
        21076, 21201, 21218, 21333, 21420, 21525, 21584, 21625, 21650, 21803,
        21848, 21886, 21996, 22068, 22165, 22198, 22202, 22212, 22338, 22344,
        22376, 22510, 22519, 22543, 22553, 22582, 22617, 22662, 22698, 22728,
        22793, 22901, 22903, 22929, 23079, 23085, 23139, 23171, 23182, 23188,
        23189, 23207, 23240, 23299, 23308, 23315, 23329, 23351, 23425, 23433,
        23464, 23471, 23490, 23491, 23510, 23552, 23809, 23812, 23892, 24075,
        24129, 24206, 24484, 24493, 24494, 24580, 24661, 24817, 25206, 25229,
        25267, 25290, 25312, 25318, 25320, 25329, 25334, 25429, 25503, 25573,
        25638, 25646, 25821, 25829, 25858, 25868, 25874, 25888, 25889, 25890,
        25917, 25918, 25955, 25986, 25988, 26047, 26051, 26055, 26067, 26078,
        26090, 26098, 26123, 26143, 26144, 26148, 26151, 26182, 26183, 26214,
        26231,
    ];

    try {
        console.log('Started refreshing ninnekos on DB.');

        for (const id of ids) {
            const data = await graphClient.request(query.pet, { id });
            console.log(`${data.pet.id} - ${data.pet.name}`);
            await ninnekos.insertDB(
                data.pet,
                graphClient,
                null,
                null,
                null,
                null
            );
        }

        console.log('Successfully refreshed ninnekos on DB.');
    } catch (error) {
        console.error(error);
    }
})();
